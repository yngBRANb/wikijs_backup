<!--
title: Создание виртуальной машины в ALT-PVE
description: 
published: true
date: 2025-03-11T04:40:52.894Z
tags: 
editor: ckeditor
dateCreated: 2025-01-15T12:22:44.175Z
-->

<p><strong>Цель работы:</strong> установить виртуальную машину в окружении ALT-PVE.&nbsp;</p>
<h1><span class="text-small"><strong>Краткие теоретические и учебно-методические материалы по теме лабораторной работы:</strong></span></h1>
<p>Альт Виртуализация — Cерверный дистрибутив на базе ядра Linux для предоставления функций виртуализации и контейнеризации в корпоративной инфраструктуре. Продукт «Альт Виртуализация» включен в Единый реестр Минцифры (регистрационный номер ПО 6487).</p>
<p>ПО основано на международных проектах СПО и выполняет все требования свободных лицензий на используемые компоненты.</p>
<p>Возможности:</p>
<ul>
  <li>Виртуализация и эмуляция аппаратных ресурсов серверов;</li>
  <li>Средства контейнеризации и оркестрации;</li>
  <li>Виртуализация дисковой подсистемы и организация программно-определяемых хранилищ данных;</li>
  <li>Виртуализация сетевой подсистемы.</li>
</ul>
<p>Основная функциональность: Альт Сервер Виртуализации предоставляет 4 основных типа установки:</p>
<ul>
  <li>Базовый гипервизор.</li>
</ul>
<p>Включает в себя поддержку виртуализации KVM на уровне ядра Linux, утилиты запуска виртуальных машин qemu и унифицированный интерфейс создания и настройки виртуального окружения libvirt. Устанавливается на отдельно стоящий сервер или группу независимых серверов. Для управления используются интерфейс командной строки virsh или графическое приложение virt-manager на рабочей станции администратора.</p>
<ul>
  <li>Кластер серверов виртуализации на основе проекта PVE (для x86_64 и aarch64, кроме ppc64le).</li>
</ul>
<p>Устанавливается на группу серверов (до 32 штук при использовании кластерной ФС ocfs2). Предназначено для управления виртуальным окружением KVM и контейнерами LXC, виртуальным сетевым окружением и хранилищем данных. Для управления используется интерфейс командной строки, а также веб-интерфейс. Возможна интеграция с корпоративными системами аутентификации (AD, LDAP и другие на основе PAM).</p>
<ul>
  <li>Облачная виртуализация уровня предприятия на основе проекта OpenNebula.</li>
</ul>
<p>Для использования необходим 1 или 3 и более серверов управления (могут быть виртуальными), и группа серверов для запуска виртуальных окружений KVM или контейнеров LXC. Возможна интеграция с корпоративными системами аутентификации.</p>
<ul>
  <li>Контейнерная виртуализация.</li>
</ul>
<p>К использованию предлагаются Docker, Podman или LXC/LXD. Для построения кластера и управления контейнерами возможно использование Kubernetes.&nbsp;</p>
<h1><span class="text-small"><strong>Задания для практической работы:</strong></span></h1>
<h2><span class="text-small">1. Знакомство с интерфейсом.</span></h2>
<p>Перейдите в веб-интерфейс ALT-PVE, который вы установили на прошлой практической работе.</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_1.png"></figure>
<p>Давайте взглянем на основные вкладки ALT-PVE:</p>
<ul>
  <li>Центр обработки данных — позволяет создать кластер и ввести в него несколько серверов alt-pve. Так же эта вкладка содержит параметры конфигурации, которые распространяются на все сервера в кластере.</li>
  <li>alt-pve — это независимая настройка конкретного сервера (у нас он всего один). Позволяет настроить сетевые параметры, диски, получить доступ к терминалу этого сервера и тд.</li>
  <li>local (alt-pve) — это текущее хранилище нашего сервера, в нем будут храниться образы и диски ВМ (обычно у каждого сервера есть свое хранилище).</li>
</ul>
<p>Вот так к примеру выглядит кластер из 2-х серверов:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_2.png"></figure>
<p>При создании кластера на базе pve и alt-pve стоит учитывать, что все узлы в кластере обладают равными правами. На каждый узел в кластере приходиться 1 quorum (голос), соответственно чтобы произвести какое-то действие, затрагивающее кластер, нужно чтобы оно было одобрено минимум 51% узлов кластера.</p>
<p>Допустим у нас в кластере 7 узлов и мы хотим удалить один из них, чтобы это произошло нужно чтобы это действие одобрили минимум 4 узла (т.е больше половины).</p>
<h2><span class="text-small">2. Создание ВМ.</span></h2>
<p>Чтобы создать ВМ нам нужно первым делом проверить свободное место текущего хранилища и отправить туда ISO образ.</p>
<p>Для этого переходим на вкладку нашего хранилища и смотрим на свободное место:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_3.png"></figure>
<p>Здесь видно что на диске свободно 98% пространства.</p>
<p>Теперь осталось закинуть в хранилище ISO образ дистрибутива ALT Linux Server.</p>
<p>Для этого переходим на подвкладку <strong>ISO-образы</strong>:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_4.png"></figure>
<p>На этой вкладке образ можно загрузить двумя способами:</p>
<ul>
  <li>Отправить — загрузить образ на сервер со своего компьютера</li>
  <li>Загрузить по URL-адресу — позволяет указать URL по которому находиться ISO образ, чтобы сам сервер грузил его напрямую. Этот способ удобен когда требуемого образа нет у вас на компьютере.</li>
</ul>
<p>Мы загрузим образ ALT Server со своего компьютера:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_5.png"></figure>
<p>Пока загружается образ, не закрывайте и не перезагружайте страницу.</p>
<p>После того как образ загрузился, начинаем создавать ВМ.</p>
<p>Для этого нажимаем на узел alt-pve ПКМ и выбираем <strong>создать ВМ</strong>:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_6.png"></figure>
<p>На первом шаге создания ВМ мы определяем:</p>
<ul>
  <li>узел на котором она запустится</li>
  <li>уникальный идентификатор VM ID</li>
  <li>имя ВМ и пул ресурсов (если он есть)</li>
  <li>автозапуск ВМ при включении гипервизора</li>
</ul>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_7.png"></figure>
<p>Далее выбираем ISO образ и тип гостевой ОС:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_8.png"></figure>
<p>На вкладке система мы определяем SCSI контроллер жесткого диска, выбираем между BIOS и UEFI и тд.</p>
<p>Мы оставим все по умолчанию:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_9.png"></figure>
<p>Вкладка диски позволяет выбрать размер виртуального диска, хранилище где он будет храниться, шину по которой будет работать и т.д</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_10.png"></figure>
<p>Далее определяем количество vCPU выделенных ВМ и их тип.</p>
<p>Для тестов линуксу можно выделить 1 vCPU:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_11.png"></figure>
<p>На вкладке Память выделяем для ВМ 3Gb ОЗУ и отключаем раздувание:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_12.png"></figure>
<p>Далее нам нужно определить сетевые параметры ВМ.</p>
<p>Мы указываем сетевой мост (Linux Bridge) к которому будет подключена ВМ, можем определить модель сетевого интерфейса ВМ (может быть важной настройкой для маршрутизаторов),</p>
<p>так же есть возможность вручную определить MAC, тег VLAN, отключить сетевой экран:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_13.png"></figure>
<p>Завершаем создание ВМ:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_14.png"></figure>
<p>Запускаем ВМ:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_15.png"></figure>
<h2><span class="text-small">3. Подключение к ВМ.</span></h2>
<p>Увидеть консоль ВМ можно либо в самом интерфейсе ATL-PVE:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_16.png"></figure>
<p>Либо в отдельном окне браузера, для этого дважды кликните на название ВМ.</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_17.png"></figure>
<h2><span class="text-small">4. Клонирование ВМ в ALT-PVE.</span></h2>
<p>В отличие от ESXi гипервизоры pve и alt-pve имеют возможность клонирования ВМ.</p>
<p>Нам нужно получить 2 ВМ ALT Server1 и ALT Server2.</p>
<p>Перед клонированием закончите установку ALT Server 1</p>
<p>Требования к установке:</p>
<ul>
  <li>Минимальная установка;</li>
  <li>Hostname - alt-server1;</li>
  <li>Адрес получайте по DHCP;</li>
  <li>Пароль от root - P@ssw0rd.</li>
</ul>
<p>После окончания установки выключите alt-server1 (можно клонировать и уже запущенную ВМ, но это может занять больше времени и привести к ошибкам)</p>
<p>Нажмите ПКМ на ВМ и выберите Клонировать:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_18.png"></figure>
<p>При клонировании нам обязательно нужно указать VM ID новой ВМ, ее имя и хранилище где она будет храниться:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_19.png"></figure>
<p>Чтобы отслеживать процесс клонирования, найдите эту задачу на нижней панели и нажмите на ее:</p>
<figure class="image"><img src="/ssa/hypervisors/alt/altvm_20.png"></figure>
<p>После окончания процесса клонирования проверьте работоспособность обоих ВМ.</p>
<p>На клоне измените hostname на alt-server2</p>
<p>Эти виртуальные машины понадобятся вам на следующей практической работе.</p>
<h1><br><span class="text-small"><strong>Контрольные вопросы:</strong></span></h1>
<ol>
  <li>Что такое Альт Виртуализация?</li>
  <li>Какие типы установки она предоставляет?</li>
  <li>На основе какого open-source проекта основан ALT-PVE? В чем их отличия?</li>
  <li>Какие есть 2 способа загрузки ISO-образов в хранилище ALT-PVE?</li>
  <li>Возможно ли создать 2 или больше ВМ с одинаковыми названиями? С одинаковыми VM ID? (Если не уверены, лучше проверьте)</li>
</ol>
