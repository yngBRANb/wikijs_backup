<!--
title: Создание и настройка роли DHCP на основном контроллере домена
description: 
published: true
date: 2025-03-11T04:53:38.570Z
tags: 
editor: ckeditor
dateCreated: 2025-01-20T10:32:11.523Z
-->

<p><strong>Цель работы: </strong>изучить процесс развертывания роли DHCP.</p>
<h1><span class="text-small"><strong>Краткие теоретические и учебно-методические материалы по теме лабораторной работы:</strong></span></h1>
<p>DHCP (Dynamic Host Configuration Protocol) — это сетевой протокол, который автоматизирует процесс назначения IP-адресов и других сетевых параметров устройствам в локальной сети, что значительно упрощает администрирование сети, устраняя необходимость вручную настраивать каждый клиент.</p>
<p>Более подробно о DHCP уже было рассказано в теоретическом материале: <a href="/theory/DHCP">DHCP</a></p>
<h1><span class="text-small"><strong>Задания для практической работы:</strong></span></h1>
<p>На этой практической работе мы рассмотрим настройку DHCP-сервера на Windows Server 2025 и получение адреса клиентским устройством.</p>
<h2><span class="text-small">1. Предварительная настройка сети</span></h2>
<p>Давайте выделим под клиентов (Windows 10) отдельную локальную сеть, а WS в дальнейшем будет выступать в качестве маршрутизатора, который будет выводить клиентов в интернет.</p>
<p>Для этого перейдите в настройки WS, создайте там новый сетевой адаптер и определите для него Сегмент локальной сети (его нужно создать)</p>
<figure class="image"><img src="/снимок_экрана_2025-01-24_082604.png"></figure>
<p>На Windows 10 не создавайте новый сетевой адаптер, а измените текущий</p>
<figure class="image"><img src="/ws_dhcp1.png"></figure>
<p>Теперь осталось настроить новый сетевой интерфейсе на WS, поставьте на него статический адрес - 192.168.188.1/24. А Windows 10 уже получит адрес автоматически (если у вас стоит статический адрес его нужно будет убрать).</p>
<figure class="image"><img src="/ssa/windows_server/ws_dhcp1.png"></figure>
<figure class="image image_resized" style="width:79.64%;"><img src="/ssa/windows_server/ws_dhcp2.png"></figure>
<figure class="image"><img src="/ws_dhcp5.png"></figure>
<figure class="image"><img src="/ws_dhcp6.png"></figure>
<figure class="image"><img src="/ws_dhcp7.png"></figure>
<p>Затем закройте все окна нажатием “ОК”</p>
<h2><span class="text-small">2. Установка роли DHCP</span></h2>
<figure class="image"><img src="https://wiki.black-sprut.pro/images/thumb/1/1e/Ws_dns1.png/700px-Ws_dns1.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_211432.png"></figure>
<figure class="image"><img src="/снимок_экрана_2025-01-24_132129.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_211602.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_211624.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_211656.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_211723.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_211748.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_211806.png"></figure>
<p>Теперь завершаем установку роли DHCP</p>
<figure class="image"><img src="/screenshot_2025-01-20_212313.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_212415.png"></figure>
<figure class="image"><img src="/screenshot_2025-01-20_212459.png"></figure>
<p>&nbsp;</p>
<h2><span class="text-small">3. Настройка области&nbsp;</span></h2>
<p><i><strong>Область (Scope)</strong> — диапазон IP-адресов, которые DHCP-сервер может назначать клиентам.</i></p>
<p>После того как вы установили роль, в Диспетчере серверов, на вкладке Средства появится пункт DHCP:</p>
<figure class="image"><img src="/screenshot_2025-01-20_223218.png"></figure>
<p>И здесь видим два пункта для создания области:</p>
<ul>
  <li>Стандартное создание области:<br>Диапазон IP-адресов, который DHCP-сервер назначает клиентским устройствам в сети. Она используется для динамического назначения адресов, которые могут быть временно выделены клиентам.</li>
  <li>Создание многоадресной области:<br>Эта область предназначена для устройств, которые должны получать данные по многоадресной рассылке, например, для потокового видео или аудио. Находятся в диапазоне от 224.0.0.0 до 239.255.255.255.</li>
</ul>
<figure class="image"><img src="/screenshot_2025-01-20_212615.png"></figure>
<p>Имя и описание области должно быть легко запоминаемое и отражать назначение или местоположение области.</p>
<figure class="image image_resized" style="width:39.71%;"><img src="/screenshot_2025-01-23_230618.png"></figure>
<p>В качестве диапазона указывайте свой интервал IP-адресов</p>
<figure class="image image_resized" style="width:40%;"><img src="/screenshot_2025-01-20_215309.png"></figure>
<p>Диапазон исключений может пригодиться для устройств, которым требуется статический адрес например принтеры, серверы и т.д.</p>
<p>Задержка может помочь избежать перегрузки сервера и дать время для восстановления.</p>
<figure class="image image_resized" style="width:40.52%;"><img src="/screenshot_2025-01-20_213034.png"></figure>
<figure class="image image_resized" style="width:40.59%;"><img src="/screenshot_2025-01-20_213141.png"></figure>
<p>Каждый IP-адрес, выданный DHCP-сервером, имеет срок аренды, который называется "временем аренды" (lease time). Это время определяет, как долго устройство может использовать данный IP-адрес. После истечения этого срока устройство должно либо продлить аренду, либо получить новый IP-адрес.</p>
<p>Вот что происходит по истечении срока аренды:</p>
<ul>
  <li><strong>Предупреждение о продлении</strong>: За некоторое время до истечения срока аренды (обычно за половину времени аренды) устройство отправляет запрос на продление аренды IP-адреса. Если DHCP-сервер согласен, он обновляет срок аренды, и устройство продолжает использовать тот же IP-адрес.</li>
  <li><strong>Истечение аренды</strong>: Если устройство не успевает продлить аренду до истечения срока, оно теряет право на использование этого IP-адреса. В этом случае устройство должно снова обратиться к DHCP-серверу для получения нового IP-адреса.</li>
  <li><strong>Получение нового IP-адреса</strong>: Устройство отправляет запрос на получение IP-адреса (DHCP Discover). DHCP-сервер отвечает, предлагая новый IP-адрес (или тот же, если он все еще доступен). Устройство принимает предложение и завершает процесс получения адреса.</li>
</ul>
<figure class="image image_resized" style="width:40.79%;"><img src="/screenshot_2025-01-20_213202.png"></figure>
<p>Введите IP-адрес шлюза, который должны использовать DHCP-клиенты.</p>
<figure class="image image_resized" style="width:40.85%;"><img src="/ssa/windows_server/ws_dhcp6.png"></figure>
<p>Далее мы должны указать DNS-сервера, которые получат клиенты. Так как у нас в качестве DNS выступает сам WS, мы укажем именно его. Здесь так же можно указать дополнительный DNS-сервер, который будет использоваться в случае если первый будет недоступен, давайте укажем 8.8.8.8.</p>
<p>Параметр Родительский домен (чаще называется как поисковый домен или dns-суффикс), отвечает за то, как клиенты будут искать устройства по доменным именам в локальной сети. Например у нас есть сервер srv1-a.novosib-cluster.local, как мы видим его доменная часть имени (novosib-cluster.local) достаточно длинная, и чтобы пользователи нашей сети ее каждый раз не вводили, мы можем определить novosib-cluster.local как родительский домен. И теперь при обращении к srv1-a пользователь будет обращаться к srv1-a.novosib-cluster.local.</p>
<figure class="image image_resized" style="width:41.17%;"><img src="/ssa/windows_server/ws_dhcp7.png"></figure>
<p>WINS - это служба сопоставления NetBIOS-имен компьютера с IP-адресами узлов, он осуществляет регистрацию имен, выполнение запросов и освобождение имен. Позволяет применять для доступа к ресурсам имена компьютеров, а не их IP-адреса. Если возникает необходимость в том, чтобы компьютер управлял сопоставлением имен и IP-адресов других компьютеров в сети то, он должен быть настроен для работы в качестве WINS-сервера.</p>
<figure class="image image_resized" style="width:41.34%;"><img src="/ssa/windows_server/ws_dhcp8.png"></figure>
<figure class="image image_resized" style="width:41.4%;"><img src="/screenshot_2025-01-20_214001.png"></figure>
<p>&nbsp;</p>
<h2><span class="text-small">4. Получение адреса клиентом</span></h2>
<p>Давайте проверим работоспособность нашего DHCP-сервера, зайдите ВМ Windows 10 и выполните команду:</p>
<pre><code class="language-plaintext">ipconfig /all</code></pre>
<p>&nbsp;</p>
<figure class="image"><img src="/ssa/windows_server/ws_dhcp9.png"></figure>
<p>И что мы здесь видим:</p>
<ul>
  <li>Текущий IPv4-адрес компьютера - 192.168.188.3</li>
  <li>Маска подсети - 255.255.255.0 (/24)</li>
  <li>Срок аренды</li>
  <li>Основной шлюз - 192.168.188.1</li>
  <li>DNS-серверы - 192.168.188.1, 8.8.8.8</li>
  <li>DHCP-сервер, который выдал нам эти параметры - 192.168.188.1</li>
</ul>
<p>Но доступа в Интернет с клиента у вас все равно пока не будет, так как Windows Server еще не настроен в качестве маршрутизатора.</p>
<p>На WS вы можете посмотреть всех текущих клиентов вашей DHCP зоны:</p>
<figure class="image image_resized" style="width:71.69%;"><img src="/ssa/windows_server/ws_dhcp10.png"></figure>
<p>Проверьте что на Windows 10 у вас Hostname WCLI, если это не так переименуйте эту ВМ</p>
<p>&nbsp;</p>
<h1><span class="text-small">Контрольные вопросы</span></h1>
<ol>
  <li>что-нибудь спрошу</li>
  <li>что-нибудь спрошу</li>
  <li>что-нибудь спрошу</li>
  <li>что-нибудь спрошу</li>
  <li>что-нибудь спрошу</li>
</ol>
<p>&nbsp;</p>
