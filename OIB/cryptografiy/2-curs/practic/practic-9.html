<!--
title: Ассиметричное шифрование. Алгоритм разложения произведения двух простых чисел на множители
description: 
published: true
date: 2025-03-11T04:58:39.894Z
tags: 
editor: ckeditor
dateCreated: 2025-01-19T10:40:49.004Z
-->

<h1>Цель работы: выработать пары «открытый/закрытый» ключ по методу RSA. Выполнить шифрование конфиденциальных данных.</h1>
<p><strong>Краткие теоретические и учебно-методические материалы по теме практической работы &nbsp;</strong></p>
<p>Задача разложения натурального числа N на простые множители (факторизация N) явлется задачей вычисления односторонней функции: зная сомножители p и q, нетрудно вычислить их произведение N=p • q, но обратная задача нахождения делителей p и q по известному N является сложной задачей, решение которой требует значительных вычислительных ресурсов.</p>
<p>На вычислительной сложности решения этой задачи построен один из самых известных асимметричных методов криптографии – метод RSA. &nbsp;В 1977 году, когда создатели этого метода Ривест, Шамир и Адлеман объявили о новом методе криптографии, основанном на задаче факторизации, наиболее длинные числа, разложимые на множители, имели длину 40 десятичных цифр, что соответствует, примерно, 132-битовому двоичному числу (число 40 надо домножить на &nbsp;). Создатели RSA предложили широкой публике расшифровать некую фразу английского языка. Для этого предварительно требовалось факторизовать 129-значное &nbsp;десятичное число N (длины 428 в битовом представлении), про которое было известно, что оно представимо в виде произведения двух простых сомножителей p и q, которые имели длину 65 и 64 десятичных знака.</p>
<p>С тех пор был достигнут значительный прогресс в этой области. Число, предложенное создателями RSA, было разложено в 1994 году с помощью нового мощного метода факторизации – метода квадратичного решета (Quadratic Sieve Factoring), разработанного Карлом Померанцем и реализованного Аткинсом, Граффом, Ленстрой и Лейлендом. В работе участвовало около 600 добровольцев, задействовано в сети около 1700 компьютеров, которые работали в течение 7 месяцев.</p>
<p>Параллельно с этим методом Джоном Поллардом, известным специалистом по криптографии и теории алгоритмов, был разработан еще более быстрый метод, получивший название метода решета числового поля (Generalizad Number Field Sieve - GNFS), который является наиболее быстрым методом и на сегодняшний день. Текущий рекорд, установленный немецкими исследователями, на июнь 2008 года, составляет 1000-бит. Это делает небезопасными ключи RSA длины 1024, которые являются на сегодняшний день, самыми распространенными.</p>
<h3><strong>Генерация пар «открытый/закрытый ключ» метода RSA.</strong></h3>
<ol>
  <li>Выбираются два простых числа p и q. Для нашего примера числа p и q должны находится в интервале от 100 до 200. В этом случае их произведение N=p • q будет иметь длину &nbsp;10 – 12 бит. В реальных задача длина N выбирается равной 512, 768 или 1024 бита (иногда 2048 для самых ответственных задач).</li>
  <li>Вычисляем их произведение N=p • q.</li>
  <li>Вычисляем функцию Эйлера &nbsp;. Значение &nbsp;равно числу натуральных чисел, меньших N, взаимно простых с &nbsp; (т.е. числу всех k &lt; N таких, что наибольший общий делитель НОД(N; k)=1).</li>
  <li>Выбираем параметр e, входящий в открытый ключ RSA, равным произвольному числу, меньшему N, но взаимно простому с &nbsp;. &nbsp;При реальном шифровании длина e выбирается приблизительно равной &nbsp;L/3, где L – длина N. Можно взять e равным произвольному простому числу, меньшему N и отличному от p и q, проверив при этом условие того, что &nbsp; не делится на е ( ).</li>
  <li>Находим параметр d, являющийся секретным параметром метода RSA, из условия &nbsp;. &nbsp;d=1/e *mod⁡ &nbsp;ϕ(N)=1. Для вычисления d необходимо воспользоваться расширенным алгоритмом Евклида, который описан ниже. Расширенный алгоритм Евклида по входным натуральным числам A и B находит их наибольший общий делитель C=НОД(А,В), а также числа x и y такие, что выполнено равенство &nbsp;. Для нахождения параметра d подставим в расширенный алгоритм Евклида входные числа &nbsp; и е. Их наибольший общий делитель C=НОД( ,е) равен 1. Если это не так, то параметр е выбран неверно. Выполнив вычисления по алгоритму Евклиду мы найдем числа x и y такие, что &nbsp;. Применив операцию &nbsp;к обеим частям последнего равенства, получим &nbsp;. Значит, можно взять значение параметра d равным коэффициенту y из метода Евклида. Однако, коэффициент y может принимать как положительные, так и отрицательные значения, а параметр d обязательно должен положительным, поэтому в случае если y &lt; 0, следует взять &nbsp;.</li>
</ol>
<p>Генерация параметров RSA завершена. Пара (N, e) объявляется открытым ключом, а параметры &nbsp; и &nbsp;d &nbsp;закрытыми параметрами (d – закрытый ключ).</p>
<h3><strong>Шифрование/расшифровка сообщений по методу RSA.</strong></h3>
<p>Текст, который следует зашифровать, разбивается на отдельные символы (или на блоки по k бит в реальных задачах, где &nbsp;, &nbsp;L – длина N в битовом представлении). Для шифрования числа с, служащего кодом символа, выполняется операция возведения в степень по формуле</p>
<figure class="image"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAAATCAIAAACGOqESAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAOxAAADsQBlSsOGwAAA4RJREFUaEPtWT12o0AMHu9ZnBT7cgI4gZ1mK7fbQZlt0rncLg2U8RFSpVk4QXwCPxeBu3il+QENngHBI8+Qx1QJaPRJnzSSGK8ul4tY1sKAED8WEhYGFANLKiyZoBmYWyqUaRyGaemOX5mGYZzmnrdfEPMyj8MVrjDOv0B9q8o8lsgjAsOsMJdVJEEQJEW7uSyhUTxGpCgrYGUR/DGKzl5KwADBx0VpXDWDjSeiF/gthfmOZ5HoQdFQnwyRQG6QZB0JOhSkdR/42XkyqAJtMdmDT6p/59IgyvT3H5E8bzhlePOcBIe/vi7C0cCRKc5HdSSL/e78ydkxskz5eQp2j2u+VrQ4isTx7R9poUQFuJJEWDrQLyx1Vg0xSVUfAQdyW2pq5aQyXcPZuV1kyh65TP2z0pdkulMYXSLZbp2soY44gKr6Cl2i89T7vDb8UA4xCpqBILIbog6QjFES9at9UETAUiyZBgxbXK1fAPHgCdYayBgsdHJHp2ssAQUriTLBqeESWPjKDpvcorilhrprvkcY9o7cI/xALB4uHq8145a1MsFMx7G5Ua904tGQsowwdJKNdqjVrCBBxkoAY1gdDjlYEQALjkbN55/zlLeR4S8LLNpsod6suzGuvK4YJ02/geUnZ8CgoCsA6pTQjUMvU6GbuAF1VSKqBZM2HawsODoNes+yy8DWg+/1aKAjIxyTK6+r2kw8aWQC3WP7yx+iVV5SeZ2TdnuAS2eUG7mcVtieIYLCNU10b3FEtj19u5ObXR3GUmWRTM80edHAoolx3Ud7padVAVQuwEBiDSL4BZG/H0T0izWc88fV9f2DOJ4LNaviVUx1F2LBwVQb/LwTcHOUlnRLmafk2ka/oeh+YZQCteLhvsd07XesHYhNiOU1/mPMgw8BARQARcAQkqYHfHiwhbjsn2ovgE9JZpq+K1xJG8cEAESa9Vo/7gJxOBwbDHHaA/sENYb16kuADsLN9JafLDrD6+8NMx1pja6j6RUe26UWIDYz/vYga3I91atvOPnE6qpQu9UdkWRGfghUI2SHFaYp0iLgaAQrUMNJq1vLwJ3y3duu+CBnxG9SL+FbezYZ/LmkArSxeLUV2eW1u5HxJScThikYMpfbRiE2r0Vy2np/ijJkQkXYnpKCkTFToH9KNswnFYRYP30Ue/HS/svki9gz28iUwjAFW+bTIKbA1re24T/dogH86zG0VgAAAABJRU5ErkJggg=="></figure>
<p>где числа N, e взяты из открытого ключа RSA. &nbsp;</p>
<p>Обратная расшифровка выполняется возведение шифра r в степень d, где d – секретный параметр RSA.</p>
<figure class="image"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAAATCAIAAACGOqESAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAOxAAADsQBlSsOGwAAA4RJREFUaEPtWT12o0AMHu9ZnBT7cgI4gZ1mK7fbQZlt0rncLg2U8RFSpVk4QXwCPxeBu3il+QENngHBI8+Qx1QJaPRJnzSSGK8ul4tY1sKAED8WEhYGFANLKiyZoBmYWyqUaRyGaemOX5mGYZzmnrdfEPMyj8MVrjDOv0B9q8o8lsgjAsOsMJdVJEEQJEW7uSyhUTxGpCgrYGUR/DGKzl5KwADBx0VpXDWDjSeiF/gthfmOZ5HoQdFQnwyRQG6QZB0JOhSkdR/42XkyqAJtMdmDT6p/59IgyvT3H5E8bzhlePOcBIe/vi7C0cCRKc5HdSSL/e78ydkxskz5eQp2j2u+VrQ4isTx7R9poUQFuJJEWDrQLyx1Vg0xSVUfAQdyW2pq5aQyXcPZuV1kyh65TP2z0pdkulMYXSLZbp2soY44gKr6Cl2i89T7vDb8UA4xCpqBILIbog6QjFES9at9UETAUiyZBgxbXK1fAPHgCdYayBgsdHJHp2ssAQUriTLBqeESWPjKDpvcorilhrprvkcY9o7cI/xALB4uHq8145a1MsFMx7G5Ua904tGQsowwdJKNdqjVrCBBxkoAY1gdDjlYEQALjkbN55/zlLeR4S8LLNpsod6suzGuvK4YJ02/geUnZ8CgoCsA6pTQjUMvU6GbuAF1VSKqBZM2HawsODoNes+yy8DWg+/1aKAjIxyTK6+r2kw8aWQC3WP7yx+iVV5SeZ2TdnuAS2eUG7mcVtieIYLCNU10b3FEtj19u5ObXR3GUmWRTM80edHAoolx3Ud7padVAVQuwEBiDSL4BZG/H0T0izWc88fV9f2DOJ4LNaviVUx1F2LBwVQb/LwTcHOUlnRLmafk2ka/oeh+YZQCteLhvsd07XesHYhNiOU1/mPMgw8BARQARcAQkqYHfHiwhbjsn2ovgE9JZpq+K1xJG8cEAESa9Vo/7gJxOBwbDHHaA/sENYb16kuADsLN9JafLDrD6+8NMx1pja6j6RUe26UWIDYz/vYga3I91atvOPnE6qpQu9UdkWRGfghUI2SHFaYp0iLgaAQrUMNJq1vLwJ3y3duu+CBnxG9SL+FbezYZ/LmkArSxeLUV2eW1u5HxJScThikYMpfbRiE2r0Vy2np/ijJkQkXYnpKCkTFToH9KNswnFYRYP30Ue/HS/svki9gz28iUwjAFW+bTIKbA1re24T/dogH86zG0VgAAAABJRU5ErkJggg=="></figure>
<p>Гарантией того, что при повторном возведении в степень, будет получено исходное число, служит теорема Эйлера, которая утверждает, что для любого &nbsp;выполняется формула</p>
<figure class="image image-style-align-left"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAAUCAIAAADKq6LJAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAOxAAADsQBlSsOGwAAA0tJREFUWEftWDuS4jAQlecsQEBxAvsEMAnRHEEOl2Qzws02scMl25SIBPsGPsGUg5HvwrZ+VksGWfbAUjVjRVhqq9Wvu5+eiS6XC5nG8xB4CXJdplFaupZNmadp2fg2aMo0zb0WQe6/tBF0QO9gWRxnzDYrKJ4qKAeJFsLGerjAy2q+1893NCAhQQOiDoYdVFlGKSUqJ86qnasQh9/Ixk9BQCFJEkWbAzlsoiTJNQ015+Nqu0bM0Jzr5c8trY5nTjistlbnSyLnv8YAPuajy8mjwvMkoMmT+a/l/i+nFFowtl/tNsorqyvbG6vJYrZWGShP78s5Wp8tVlXNRh3v1ktNniZ3QmDwudZ/oMMJtQrQexHmUMMwkvY2BGTNzM1uB9glo7QEZJjI5aSCSooSl0WWuRdGl8I+wTEMGE3E+7ybpYUmMAyeMBgIFj4jH70UVNXAHOXpQLdzkDzJBn5I3pkvJQZqtCU/e30ju91xtZjh5ebjPbZaYnDRtS9A5f/+2IqmfN7g8by9WiH6DwOEwW9IRdDKVm+hksiKTBWWqS24WA3OMc0KI4TwNWuJHtGdUgy148YlrOri+tk7qsvdMrQDVBD8TLp3xN46OOyIG6iIIVxL9rV9B4WbdTSJvxMkhXOYtDMkK6UKEotgpFkE+b5FH8HS5iEylB84hIKgrCAqQRkweICi+aEexQPeRtRDrKrMUIRi1hYfiZUryn0Z0GijFxGoPAG+LT30zZsGd8WVQ0DanUoKZM0+s9AEiH0EtDpdol/Rg8bSAQE7sJdGXADKR+sagwoJGBRMHzID1v8PBama1yVrlTaK3MEfm9n4XOPYnvpv860qwfquJbInh7TUAIwfZjqkaCxbXL9owQHB4WuEzxDHmt0NV8oMwEVj8H4hoNIJyHTxocS1zrPk9aNUDag4I9r5g9ZoIGYIqDP+f1VJOAjqaxEm4MuT7n8YnSM/YwCd/CSPCWos7D8ucIgUIKjEmBwOFZaJgiO12lEX8cMK9/Mb87MiCRy7aqXjwaptu9ClfDOXgN7XFnzA0UrG8/tciBktWPrC0STr/muG5UMEmzyq9qZ9AxAI+zs6YKPJZBwCUwLG4Xa3t6YE3A3KcRtNCRiH293e+gc2QhnphtrL6wAAAABJRU5ErkJggg=="></figure>
<p>. Проверим &nbsp;операцию (**):</p>
<figure class="image"><img src="data:image/png;base64,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"></figure>
<p><strong>Задание.</strong></p>
<ol>
  <li>Выбрать p и q из простых чисел диапазона от 100 до 200.</li>
  <li>Сгенерировать открытый и закрытый ключ.</li>
  <li>Создать алфавит, сопоставить с кодовой таблицей.</li>
  <li>Зашифровать свои ФИО закрытым ключом.</li>
  <li>Расшифровать ЗТ открытым ключом.</li>
</ol>
<p><strong>Контрольные вопросы:</strong></p>
<ol>
  <li>Какая алгоритмически сложная задача лежит в основе метода RSA?</li>
  <li>Что такое простое число? Какие методы проверки простоты числа вы знаете?</li>
  <li>Как генерируется параметры метода RSA?</li>
  <li>Как производится процедура шифрования/расшифровки в методе RSA?</li>
  <li>Какой длины должны быть простые числа p и q в методе RSA, чтобы обеспечить необходимый уровень надежности?</li>
</ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
