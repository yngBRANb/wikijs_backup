<!--
title: Установка Nginx
description: 
published: true
date: 2025-03-11T05:17:06.672Z
tags: 
editor: ckeditor
dateCreated: 2025-02-02T20:28:56.857Z
-->

<h2><strong>Установка Nginx на Ubuntu</strong>:&nbsp;</h2>
<ol>
  <li>Откройте терминал.</li>
  <li>Введите команду, чтобы обновить список доступных пакетов: <code>sudo apt update</code></li>
  <li>Для установки Nginx примените команду: <code>sudo apt install nginx</code></li>
  <li>После установки Nginx будет автоматически запущен. Чтобы убедиться, что он работает, пропишите команду: <code>sudo systemctl status nginx</code></li>
  <li>Откройте веб-браузер и введите IP-адрес вашего сервера или его доменное имя. Если установка прошла успешно, вы должны увидеть страницу приветствия Nginx</li>
</ol>
<p><strong>Для других дистрибутивов Linux</strong> команды для установки отличаются:</p>
<ul>
  <li>Для deb-based дистрибутивов (Debian и другие) — <code>sudo apt update &amp;&amp; sudo apt install nginx</code></li>
  <li>для rpm-based CentOS и прочие — <code>sudo dnf update &amp;&amp; sudo dnf install nginx</code></li>
</ul>
<p>После установки Nginx рекомендуется настроить брандмауэр для получения доступа к Nginx извне:</p>
<h2><strong>С помощью ufw:</strong></h2>
<ol>
  <li>Обновите и установите утилиту с помощью команд: <code>sudo apt update и sudo apt install ufw</code></li>
  <li>Добавьте веб-сервер в список доступных приложений брандмауэра: <code>sudo nano /etc/ufw/applications.d/nginx.ini</code> В открывшемся файле отредактируйте строки для профилей Nginx:&nbsp;<br>Nginx Full (открывает порты 80 и 443), Nginx HTTP (для незашифрованного трафика HTTP на порт 80),&nbsp;<br>Nginx HTTPS (для зашифрованного трафика TLS/SSL на порт 443). Сохраните внесённые изменения и закройте редактор.</li>
  <li>Проверьте список доступных приложений с помощью команды: <code>sudo ufw app list</code>&nbsp;<br>Если на экране в списке <mark class="pen-green">«Available applications»</mark> отображается веб-сервер, то настройки верны.</li>
  <li>Активируйте брандмауэр и разрешите передачу трафика через указанные порты: <code>sudo ufw enable и sudo ufw allow 'Nginx Full'</code></li>
  <li>Проверьте корректность настроек и их статус с помощью команды: <code>sudo ufw status</code></li>
</ol>
<p>При изменении настроек брандмауэра важно быть осторожным, чтобы не заблокировать важные сервисы и приложения.</p>
<h2><strong>С помощью iptables:</strong></h2>
<p>Чтобы настроить брандмауэр для получения доступа к Nginx с помощью iptables, нужно:</p>
<ol>
  <li>Добавить правила форвардинга. Например, чтобы трафик, поступающий на порт 80 открытого интерфейса eth0, перенаправлялся на закрытый интерфейс eth1, нужно ввести команду:</li>
</ol>
<p><code>sudo iptables -A FORWARD -i eth0 -o eth1 -p tcp --syn --dport 80 -m conntrack --ctstate NEW -j ACCEPT</code></p>
<p>Это правило пропустит через брандмауэр первый пакет, который предназначен для создания соединения. Также необходимо разрешить любой последующий трафик в обоих направлениях, что является результатом этого соединения.&nbsp;</p>
<ol>
  <li>Добавить правила NAT. Чтобы iptables мог правильно изменять пакеты и поддерживать взаимодействие между клиентами и веб-сервером, нужно выполнить две операции:</li>
  <li>Операция DNAT в цепи PREROUTING таблицы nat изменяет целевой адрес пакета. Клиенты будут подключаться к серверу брандмауэра по общедоступной сети, не подозревая о перенаправлении пакетов.</li>
  <li>Чтобы настроить правильную переадресацию, нужно изменить исходный адрес пакета. Этот адрес нужно заменить внутренним IP-адресом сервера брандмауэра (в данном примере это 192.0.2.15). Для этого нужно добавить правило в цепочку POSTROUTING в таблицу nat:</li>
</ol>
<p><code>sudo iptables -t nat -A POSTROUTING -o eth1 -p tcp --dport 80 -d 192.0.2.2 -j SNAT --to-source 192.0.2.15</code></p>
<p>После этого веб-сервер будет доступен в браузере, если направить его на внешний адрес хоста брандмауэра.&nbsp;</p>
<blockquote>
  <p><strong>При настройке iptables через удалённое ssh-соединение следует соблюдать осторожность, так как одна неверная команда может заблокировать возможность подключения к удалённому серверу</strong></p>
</blockquote>
