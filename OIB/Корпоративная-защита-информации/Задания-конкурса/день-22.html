<!--
title: День 2 | Часть вторая
description: 
published: true
date: 2025-03-11T05:13:17.759Z
tags: 
editor: ckeditor
dateCreated: 2025-02-02T19:22:37.361Z
-->

<h1>Модуль A: Установка, конфигурирование и устранение неисправностей в корпоративных системах защиты информации</h1>
<p>Вы работаете инженером в центре информационной безопасности (департамент проектирования и внедрения) одного из интеграторов&nbsp;DEMO&nbsp;Lab.</p>
<p>Вам поручили собрать демонстрационный стенд в отдельной «песочнице» (тестовом контуре) и развернуть DLP-систему на отдельном сегменте сети.&nbsp;</p>
<p>В «песочнице» развернуты два контроллер домена (с каталогом Active Directory и&nbsp;ALD&nbsp;Pro), с которым необходимо будет осуществить интеграцию DLP-системы.&nbsp;</p>
<p>В качестве виртуальной инфраструктуры для пилотного проекта используется среда виртуализации &nbsp;VMWare&nbsp;Workstation.</p>
<p>В качестве DLP-системы выбран продукт InfoWatch Traffic Monitor (IWTM). Необходимо развернуть компоненты уровня сети (network) и хоста (endpoint).</p>
<p>Вам необходимо установить и настроить компоненты DLP-системы в соответствии с выданным заданием.&nbsp;</p>
<p>Необходимо использовать следующие виртуальные машины:</p>
<ul>
  <li><strong>Demo.lab</strong> (контроллер домена&nbsp;demo.lab)</li>
  <li><strong>ALD.Lab&nbsp;</strong>&nbsp;(контроллер домена&nbsp;aldpro.lab)</li>
  <li><strong>IWTM&nbsp;</strong>(Astra Linux 1.7.0)</li>
  <li><strong>IWDM</strong> (Astra&nbsp;Linux 1.7.3)</li>
  <li><strong>Astra-cli</strong>&nbsp;(ПК&nbsp;Astra&nbsp;нарушителя)</li>
</ul>
<p>Сетевые настройки виртуальных машин указаны в дополнительной карточке заданий.</p>
<p>Основными каналами потенциальной утечки данных являются носители информации, электронная почта и различные интернет-ресурсы.</p>
<p>В компании развернут домен со всеми сотрудниками с указанием ФИО, должности и контактов.&nbsp;</p>
<p>При выполнении заданий можно пользоваться справочными ресурсами в сети Интернет и документацией на компьютерах.</p>
<p>Если в задании необходимо сделать скриншот, необходимо называть его по номеру задания, например: Задание_5_копирование.jpg.</p>
<p>Динамичное развитие компании Demo.Lab привело к значительному расширению штата и переезду в новый офис. В связи с этим, принято решение о расширении всей ИТ-инфраструктуры компании, в том числе и систем обеспечения корпоративной безопасности.&nbsp;</p>
<p>Необходимо мигрировать решение InfoWatch Traffic Monitor (IWTM), согласно рекомендациям, полученным от подразделений внедрения ГК Инфовотч. Основная идея – максимальное разнесение компонент уровня сети (network, IWTM) и хоста (endpoint, IWDM) для распределения нагрузки в связи с увеличением числа сотрудников.</p>
<p><strong>По возможности все имеющиеся настройки и события в системе (как IWTM, так и IWDM) необходимо сохранить при миграции.</strong></p>
<h2 style="text-align:justify;">Задание 1: Развертывание DLP уровня сети. InfoWatch Traffic Monitor.</h2>
<p style="text-align:justify;">В качестве DLP-системы выбран продукт InfoWatch Traffic Monitor (IWTM). Необходимо мигрировать или развернуть с нуля компоненты уровня сети (network) и хоста (endpoint).</p>
<p style="text-align:justify;">В соответствии с Вашей частью пилотного проекта на отдельном сегменте сети «песочницы» Заказчика необходимо мигрировать или установить с нуля на 2 разных машины следующие сетевые компоненты InfoWatch Traffic Monitor:</p>
<ul>
  <li style="text-align:justify;">Основной сервер безопасности IWTM (Node) (Astra&nbsp;Linux 1.7.0)</li>
  <li style="text-align:justify;">База&nbsp;данных IWTM (Database)&nbsp;(Astra Linux 1.7.0)</li>
</ul>
<p style="text-align:justify;">Система, установленная без сохраненных событий допустима, но оценивается меньшим количеством баллов. Необходимо мигрировать Node или Database сервер на отдельную машину, которую предварительно необходимо создать самостоятельно и дать ей имя в соответствии с тем, какой компонент мигрируете –&nbsp;iwtm_db или&nbsp;iwtm_node. Для развертывания машины можно воспользоваться&nbsp;OVA образом подготовленной операционной системы&nbsp;Astra&nbsp;Linux (информация находится в дополнительной карточке).</p>
<p style="text-align:justify;">Параметры IWTM: версия — Enterprise, СУБД — PostgreSQL.</p>
<p style="text-align:justify;">Все развернутые сервера должны быть доступны для управления (службы) и мониторинга из консоли управления IWTM.</p>
<p style="text-align:justify;">Ваша задача — установить указанные компоненты IWTM используя распределенный сценарий установки.</p>
<p>Подтвердить выполнение задания скриншотами (основные моменты: правка конфигурационных файлов, изменение настроек, проверка работоспособности, отчет о состоянии системы в web-консоли IWTM).<strong>&nbsp;</strong></p>
<h2><strong>Задание 2: Развертывание DLP уровня хоста. InfoWatch Device Monitor.</strong></h2>
<p>В соответствии с Вашей частью пилотного проекта сети Заказчика необходимо произвести миграцию следующих endpoint-компонентов InfoWatch Device Monitor (IWDM):</p>
<ul>
  <li>Основной сервер безопасности (Node)&nbsp;</li>
  <li>База данных IWDM-DB (Database). <strong>Сохранение всех событий и конфигураций будет значительным плюсом.</strong>&nbsp;</li>
</ul>
<p>Версия СУБД IWDM для установки или миграции — PostgreSQL.</p>
<p style="text-align:justify;">Необходимо мигрировать Node или Database сервер на отдельную машину, которую предварительно необходимо создать самостоятельно и дать ей имя в соответствии с тем, какой компонент мигрируете –&nbsp;iwdm_db или&nbsp;iwdm_node. Для развертывания машины можно воспользоваться&nbsp;OVA образом подготовленной операционной системы&nbsp;Astra&nbsp;Linux (информация находится в дополнительной карточке).</p>
<p>В случае невозможности сохранения конфигурации допускается установка с нуля. Это не будет являться полным выполнением задания, но позволит перейти к следующим этапам.</p>
<h2>Задание 3: Проверочная политика</h2>
<p>Для проверки правильности разнесения компонентов&nbsp;IWTM необходимо создать:</p>
<ol>
  <li>проверочную политик на проверку на копирование, передачу, буфер обмена, хранение.&nbsp;</li>
  <li>Необходимо создать отдельную выборку на указанную политику.</li>
</ol>
<p>В качестве объекта защиты необходимо использовать технологию с фразой: «Разнесение настроено успешно!»</p>
<p><i>Зафиксировать скриншотом работоспособность.</i></p>
<h2>Задание 4: Беспарольное SSH-соединение защищенного доступа к IWTM&nbsp;</h2>
<p>Для удаленного управления&nbsp;<strong>IWTM (Node)</strong> настройте безопасный беспарольный (по ключу) доступ по SSH (используя программу PuTTY, с помощью&nbsp;RSA-ключа)&nbsp;с&nbsp;контроллера&nbsp;домена (AD Demo.lab, Domain Controller).&nbsp;</p>
<p>Парольная фраза для ключа (если применимо): xxXX1234 (или своя, поместить в файл отчета на рабочем столе), файл ключа также сохранить рядом с файлом отчета.</p>
<p>Зафиксируйте все этапы (генерация ключа, подключение) выполнения задания скриншотами. Необходимо сохранить&nbsp;SSH-сессию в&nbsp;SSH-клиенте для проверки&nbsp;</p>
<h2>Задание 5. Защита HTTPS-соединения с IWTM. Создание цифровых сертификатов</h2>
<p>Для корректной работы некоторых сервисов, предоставляемых внутри компании, заказчику необходимо развернуть структуру PKI. Сгенерированные сертификаты не должны иметь ошибок, критических полей (кроме указанных) или неверных данных. Так же после генерации всех сертификатов, они должны быть установлены в локальное хранилище на контроллере домена.&nbsp;</p>
<p>Все сертификаты и соответствующие им закрытые ключи должны быть помещены в папку на рабочем столе. Далее указана информация для сертификатов, которую они должны содержать. Можно использовать любое удобное ПО для работы с сертификатами, не допускается ошибок в основных и дополнительных полях сертификата.</p>
<h2>Общие свойства (поля) для всех сертификатов:</h2>
<ul>
  <li>Страна:&nbsp;RU</li>
  <li>Город:&nbsp;SpB</li>
  <li>Область:&nbsp;SpB</li>
  <li>Организация: FIRPO</li>
  <li>Подразделение:&nbsp;IT</li>
</ul>
<h2>Корневой сертификат:</h2>
<p>commonName:&nbsp; CA<br>E-mail:&nbsp;<a href="mailto:ca-support@demo.lab">ca-support@demo.lab</a></p>
<p>Период действия:&nbsp;&nbsp;&nbsp;&nbsp; 10 лет&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Альтернативные имена субъекта по DNS: CA; CA.demo.lab</p>
<h2>Промежуточный сертификат:</h2>
<p>commonName:&nbsp; Intermediate<br>E-mail:&nbsp;support@demo.lab</p>
<p>Альтернативные имена субъекта по DNS: Intermediate; Intermediate.demo.lab</p>
<h2>Серверный сертификат:</h2>
<p>E-mail:&nbsp;<code>iwtm@demo.lab</code></p>
<ul>
  <li>Алгоритм подписи: SHA 256</li>
  <li>Закрытый ключ:&nbsp;RSA:2048 bit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
  <li>Период действия:&nbsp;&nbsp;&nbsp;&nbsp; 365 дней</li>
</ul>
<h2>Пользовательский сертификат (должен запрашиваться с клиентов при соединении с сервером&nbsp;IWTM):</h2>
<p>E-mail:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user@demo.lab</p>
<p>Период действия:&nbsp;&nbsp;&nbsp;&nbsp; 365 дней</p>
<p><i>Генерацию сертификатов зафиксируйте скриншотами.&nbsp;</i></p>
<p><i>Созданные сертификаты, ключи, скрипты для их создания и скриншоты процесса разместите в папке «Certificates&nbsp;IWTM» на рабочем столе компьютера.</i></p>
<h2>Задание 6. Защита&nbsp;HTTPS-соединения с&nbsp;IWTM. Использование цифровых сертификатов</h2>
<p>Примените цифровые сертификаты для защиты клиент-серверного соединения по протоколу HTTPS при подключении к веб-консоли IWTM со всех узлов сети домена по&nbsp;DNS-имени вашего Traffic Monitor. Для этого необходимо установить серверный сертификат на веб-сервер Traffic Monitor, а клиентский — на устройства в сети.</p>
<p>Проверку необходимо осуществить с помощью браузера Google Chrome. Проверка должна производиться через всплывающее окно запроса сертификата.</p>
<p><i>Зафиксируйте все этапы выполнения задания (настройка веб-сервера, установка защищенного HTTPS-соединения и т. п.) скриншотами.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i><br><i>Необходимо указать в отчете, с помощью какого&nbsp;DNS имени осуществлялась проверка соединения.</i></p>
<h1>Модуль Е:&nbsp; Анализ выявленных инцидентов</h1>
<p>Необходимо установить, настроить и проверить IW ARMA IF.</p>
<p>Задание включает проверку на обнаружение известных атак (сгенерированных участником).&nbsp;</p>
<p>Все действия необходимо документировать скриншотами в формате: IDS-2-1-3, где T — Task (задача), 1 — номер задания, 2 — подпункт задания (при наличии), 3 — шаг.&nbsp;</p>
<p>На каждое задание ОБЯЗАТЕЛЬНО необходимо сохранять скриншоты всех действий по изменению настроек (установка, использование конструктора фильтров, создание отчетов и т. д.) и проверке работоспособности системы и правил. Формат скриншотов для документирования действий указан выше.&nbsp;</p>
<p>ВАЖНО! Запрещается воздействовать на инфраструктуру чемпионата, объекты информатизации на площадки и за пределами площадки, машины других участников и экспертов. Объектами атак при моделировании угроз должны быть только собственные виртуальные машины.&nbsp;</p>
<p>При выполнении заданий рекомендуется использовать следующие виртуальные машины:</p>
<ul>
  <li>IW ARMA IF (необходимо создать и настроить),</li>
  <li>дистрибутивы для тестирования (Kali) или иные свободные утилиты и ОС.</li>
</ul>
<h2><strong>Задание 1. Начальная установка и настройка систем IW ARMA IF&nbsp;</strong></h2>
<p>1. Образ IW ARMA IF необходимо развернуть в VMWare Workstation.&nbsp;</p>
<p>a. Для подключения возможны два варианта (настроить интерфейсы, адресацию для интерфейсов выбрать самостоятельно):&nbsp;</p>
<p>1) Использовать 1 сетевой интерфейс для управления, 2 — для перехвата трафика (в общей сети NAT)&nbsp;</p>
<p>2) Использовать один интерфейс для всех VM в неразборчивом режиме&nbsp;</p>
<p>b. Настроить нового администратора системы с полным доступом (officer).&nbsp;</p>
<p>с. Загрузить и применить актуальные правила (результат успешной загрузки зафиксировать).&nbsp;</p>
<p>d. Настроить подключение&nbsp;ARMA к&nbsp;syslog серверу.&nbsp;<strong>IP: 172.23.5.4</strong>. Порт подключение&nbsp;TCP – 514.</p>
<p>Зафиксировать выполнение задания скриншотами: настройка сетей, пользователей.</p>
<p>Записать все логины и пароли в файле ARMA.txt на рабочем столе!&nbsp;</p>
<h2><strong>Задание 2. Проверка системы на выявление известной атаки</strong></h2>
<p>Некоторый злоумышленник совершит атаку на наш веб-сайт, формируя специальное значение поля Range заголовка http, передаст туда довольно большое количество байт(&gt;100000000). Известно что запрос будет отправлен на http://{ip msf1: 2k8}/welcome.png&nbsp; и будет представлять собой “Range: bytes=184944-18446744073709551615”, наша задача не допустить подобного рода атак и провести проверку количества байт (&gt;1000000000). В правиле используйте ключевое слово “byte_test” для оценки количества.</p>
<ol>
  <li>Напишите пользовательское правило IW ARMA IF, которое позволяет оповещать пользователя о такого рода атаках (msg: " WSR-RULE MS15-034 Detected ").&nbsp;</li>
  <li>Проведите проверку собственного правила.</li>
  <li>Провести детектирование трафика согласно указанным правилам с помощью ARMA. Для получения трафика необходимо обратится к Главному эксперту.</li>
</ol>
<p>3. Подготовить раздел в отчете об обнаруженной атаке согласно прилагаемому в дополнительных файлах шаблону&nbsp;</p>
<p>Зафиксировать выполнение задания (правила и обнаруженные события) скриншотами и приложить их в отчет.&nbsp;</p>
<p>Главный эксперт выполняет отсылку трафика только&nbsp;<strong>ТРИ&nbsp;</strong>раза.</p>
<h2><strong>Задание 3. Проверка системы на выявление неизвестной атаки на веб-сервер с поддержкой PHP (PHP FPM)</strong></h2>
<p>Известно, что на сервер Nginx была проведена попытка использования уязвимости, позволяющей удаленное выполнение произвольного кода, при помощи эксплуатации уязвимости в PHP.</p>
<p>Для выполнения данного задания необходимо иметь настроенную и работоспособную&nbsp;IW&nbsp;ARMA. Для получения трафика необходимо запросить Главного эксперта.&nbsp;</p>
<p>После получения трафика на свою инфраструктуру необходимо изучить полученный трафик, подготовить правило на детектирование данного вида атак и подготовить раздел в отчете.</p>
<p>Для автоматизации проверки в поле&nbsp;msg необходимо добавить сообщение «WSR-CVE-2023»</p>
<p>Зафиксировать выполнение задания (правила и обнаруженные события) скриншотами и приложить их в отчет.&nbsp;</p>
<p>Главный эксперт выполняет отсылку трафика только&nbsp;<strong>ТРИ&nbsp;</strong>раза.</p>
<h2><strong>Задание 4. Формирование отчетов</strong></h2>
<p>1. Сформировать отчет в IW ARMA IF по событиям из задания&nbsp;</p>
<p>Все отчеты зафиксировать скриншотами.</p>
